<section class="form-conteiner">
    <h2>Novo Produto</h2>

    <form #formulario = "ngForm" (ngSubmit)="onSubmit(formulario)">
        <div class="campo">
            <label for="nome">Nome</label>
            <input type="text" id="nome" name="nome" [(ngModel)]="novoProduto.nome" required minlength="3"/>
            
        <!--<small class="erro" [hidden]="!(formulario.submitted && formulario.controls['nome'].invalid)"></small>-->
            <small class="erro" [hidden]="!(formulario.controls['nome']?.dirty && formulario.controls['nome'].invalid)">
                Nome é obrigatório com ao menos 3 caracteres
            </small>
        </div>
        <div class="campo">
            <label for="preco">Preco</label>
            <input type="number" id="preco" name="preco" [(ngModel)]="novoProduto.preco" required minlength="3"/>
            
        <!--<small class="erro" [hidden]="!(formulario.submitted && formulario.controls['nome'].invalid)"></small>-->
           @if(formulario.controls['preco']?.dirty && formulario.controls['preco'].invalid){
            <small class="erro">Informe um preço valido</small>
           }
        </div>

        <div class="campo">
            <label for="descricao">Descrição</label>
            <textarea id="descricao" name="descricao" [(ngModel)]="novoProduto.preco" required></textarea>
            
        <!--<small class="erro" [hidden]="!(formulario.submitted && formulario.controls['nome'].invalid)"></small>-->
           @if(formulario.controls['descricao']?.dirty && formulario.controls['descricao'].invalid){
            <small class="erro">Informe uma descrição</small>
           }
        </div>

        <div class="campo">
            <label for="categoria">Categoria</label>
            <select id="categoria" name="categoria" [(ngModel)]="categoriaSelecionada" required="">
                <option value="">Selecione...</option>
                @for (categoria of categorias(); track categoria){
                    <option [value]="categoria">{{ categoria }}</option>
                }
            </select>
            <small class="erro" [hidden]="!(formulario.controls['categoria']?.dirty && formulario.controls['categoria'].invalid)">Selecione uma categoria</small>
        </div>

        @if(mostrarNovaCategoria()){
            <div class="campo">
                <label for="novaCategoria">Nova Categoria</label>
                <input type="text" id="novaCategoria" name="novaCategoria"
                    [(ngModel)]="novaCategoria" required
                    placeholder="Digite uma nova categoria"/>
                @if(mostrarNovaCategoria() && formulario.controls['novaCategoria']?.dirty && novaCategoria().trim().length == 0){
                    <small class="erro">Digite uma nova categoria</small>
                }
            </div>
        }

        <div class="erro">
            <label for="imageUrl">URL da Imagem</label>
            <input type="text" id="imageUrl" name="imageUrl" [(ngModel)]="novoProduto.imageURL" required/>
            @if(formulario.controls['imageUrl']?.dirty && formulario.controls['imageUrl'].invalid) {
                <small class="erro">Informe a URL da imagem</small>
            }
        </div>

        <div class="campo check">
            <label for="promo">
                <input type="checkbox" id="promo" name="promo" [(ngModel)]="novoProduto.promo">
                Em Promoção
            </label>
        </div>

        <div class="botoesform">
            <button type="submit" [disabled]="enviando()">Salvar Produto</button>
            <button type="button" class="botaocancelar" (click)="onReturnToList()">Cancelar</button>

        </div>
    </form>

</section>